# ADR-002: Arquitetura

## Status
Aprovado

## Contexto
O módulo de clientes é a base do CRM e ponto de integração com faturamento,
suporte e marketing. Regras de negócio complexas (distinção PF/PJ, validação
de IE, unicidade por CPF/CNPJ e e-mail, compliance de idade mínima) exigem
um domínio rico, isolado de detalhes de infraestrutura e fácil de evoluir.

## Opções Consideradas

| Opção                  | Prós                                              | Contras                                         |
|------------------------|---------------------------------------------------|-------------------------------------------------|
| DDD + CQRS + MediatR   | Domínio isolado, leituras e escritas independentes | Mais arquivos e camadas que um CRUD simples     |
| CRUD com EF Core puro  | Simples e rápido de implementar                   | Regras de negócio vazam para controllers/services|
| Clean Architecture     | Separação clara de dependências                   | Sem modelagem rica de domínio por padrão        |

## Decisão
Domain-Driven Design (DDD) com separação em quatro camadas, CQRS implementado com MediatR.

## Estrutura de Camadas
- Domain: Entidades ricas, Value Objects, Domain Events, Interfaces
- Application: Commands, Queries, Handlers, Pipeline Behaviors, Validators
- Infrastructure: EF Core, Repositórios, Event Store, Clientes HTTP
- API: Controllers, Middlewares, DTOs, Scalar


## Consequências
- Regras de negócio encapsuladas no domínio — nunca vazam para controllers ou repositórios
- CQRS separa leituras (Queries) de escritas (Commands) permitindo evolução independente
- MediatR desacopla quem dispara uma ação de quem a executa
- Maior quantidade de arquivos é justificada pelo nível de complexidade e pela
  necessidade de manutenibilidade a longo prazo
