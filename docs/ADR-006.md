# ADR-006: Result Pattern

## Status
Aprovado

## Contexto
A API precisa retornar respostas consistentes em todos os endpoints —
sucessos, erros de validação e erros inesperados — para facilitar o consumo
pelo frontend e por futuras integrações.

## Decisão
Contrato fixo de resposta em todos os retornos da API, implementado via
classe genérica `Result<T>` na camada Application e reforçado por um
`GlobalExceptionMiddleware` na camada API.

## Contrato

```json
// Sucesso
{
  "success": true,
  "message": "Cliente cadastrado com sucesso.",
  "data": { },
  "errors": []
}

// Erro
{
  "success": false,
  "message": "Erro de validação.",
  "data": null,
  "errors": [
    { "code": "DOCUMENTO_INVALIDO", "message": "CPF informado não é válido." },
    { "code": "EMAIL_DUPLICADO",    "message": "Este e-mail já está cadastrado." }
  ]
}
```

## Implementação
```csharp
// Métodos estáticos para construção semântica
Result<CustomerDto>.Ok(data, "Cliente cadastrado com sucesso.");
Result<CustomerDto>.Fail("Erro de validação.", errors);
```

O GlobalExceptionMiddleware intercepta qualquer exceção não tratada e
a converte para o mesmo contrato, garantindo que o frontend nunca receba
uma resposta fora do padrão.

## Consequências
- Frontend sempre recebe o mesmo formato — sem tratamento de casos especiais
- Erros de validação do FluentValidation são mapeados automaticamente para o campo errors
- Exceções inesperadas nunca expõem stack traces — retornam success: false com mensagem genérica
- Futuras integrações (faturamento, suporte, etc.) consomem o mesmo contrato